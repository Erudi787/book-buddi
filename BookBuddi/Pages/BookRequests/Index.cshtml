@page
@model BookBuddi.Pages.BookRequests.IndexModel
@{
    ViewData["Title"] = "Book Requests";
}

<h1>Book Requests</h1>

<p><a href="/BookRequests/Create">Create New Request</a></p>

<h2>Pending Requests</h2>
<table border="1">
    <thead>
        <tr>
            <th>ID</th>
            <th>Member</th>
            <th>Book Title</th>
            <th>Author</th>
            <th>Request Date</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var request in Model.Requests.Where(r => r.Status == BookBuddi.Models.Enums.RequestStatus.Pending))
        {
            <tr>
                <td>@request.RequestId</td>
                <td>@request.Member?.FirstName @request.Member?.LastName</td>
                <td>@request.BookTitle</td>
                <td>@request.AuthorName</td>
                <td>@request.RequestDate.ToString("yyyy-MM-dd")</td>
                <td>@request.Status</td>
                <td>
                    <a href="/BookRequests/Approve?id=@request.RequestId">Approve</a> |
                    <a href="/BookRequests/Reject?id=@request.RequestId">Reject</a>
                </td>
            </tr>
        }
    </tbody>
</table>

<h2>All Requests</h2>
<table border="1">
    <thead>
        <tr>
            <th>ID</th>
            <th>Member</th>
            <th>Book Title</th>
            <th>Status</th>
            <th>Request Date</th>
            <th>Response Date</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var request in Model.Requests)
        {
            <tr style="@(request.Status == BookBuddi.Models.Enums.RequestStatus.Pending ? "background-color: #ffffcc;" : "")">
                <td>@request.RequestId</td>
                <td>@request.Member?.FirstName @request.Member?.LastName</td>
                <td>@request.BookTitle</td>
                <td>@request.Status</td>
                <td>@request.RequestDate.ToString("yyyy-MM-dd")</td>
                <td>@(request.StatusUpdateDate?.ToString("yyyy-MM-dd") ?? "-")</td>
            </tr>
        }
    </tbody>
</table>

<p><a href="/">Back to Home</a></p>
